% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sampling.R
\name{.compute_sample_size_wilson}
\alias{.compute_sample_size_wilson}
\title{Compute required sample size (Wilson method)}
\usage{
.compute_sample_size_wilson(
  p,
  r,
  conf.level = 0.95,
  n_upper = 1e+07,
  ceiling_out = TRUE
)
}
\arguments{
\item{p}{Numeric vector of true proportions (0 < \code{p} < 1).}

\item{r}{Numeric vector of target relative margins of error (0 < \code{r} < 1).}

\item{conf.level}{Confidence level for the interval (default: 0.95).}

\item{n_upper}{Maximum search bound for \code{n} (default: 1e7).}

\item{ceiling_out}{Logical; if \code{TRUE} (default), rounds up to the next integer.}
}
\value{
A numeric vector of sample sizes (same length as \code{p}).
Returns \code{NA} if the solution exceeds \code{n_upper}.
}
\description{
Calculates the minimum sample size needed to achieve a specified
\emph{relative margin of error} for an estimated proportion using the
\strong{Wilson score confidence interval} (numerical search).
}
\details{
The function iteratively increases \code{n} until the half-width of the Wilson
score interval is no greater than \code{r * p}.
The Wald approximation is used as an initial guess for faster convergence.

The Wilson half-width at sample size \code{n} is computed as:
\deqn{
  h = \frac{z \sqrt{p(1-p)/n + z^2/(4n^2)}}{1 + z^2/n}
}
}
\keyword{internal}
