% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/excel.R
\name{save_plot_xlsx}
\alias{save_plot_xlsx}
\title{Save ggplot object(s) to a single Excel sheet (stack or fixed positions)}
\usage{
save_plot_xlsx(
  plot,
  file,
  sheet = "Plots",
  rc = c(1L, 1L),
  width = 8,
  height = 4,
  dpi = 300,
  plot_titles = NULL,
  title_size = 14,
  font_name = getOption("instead.font"),
  row_spacer = 2L,
  rows_per_inch = 5,
  overwrite = FALSE
)
}
\arguments{
\item{plot}{A ggplot object or a non-empty list of ggplot objects.}

\item{file}{Path to the target \code{.xlsx} workbook.}

\item{sheet}{Target sheet name (created if missing). Default \code{"Plots"}.}

\item{rc}{Either a single \code{c(row, col)} (stack mode) or a list of such
vectors (fixed positions).}

\item{width, height}{Plot size in inches (passed to \code{openxlsx::insertPlot()}).}

\item{dpi}{Image resolution for \code{openxlsx::insertPlot()}. Default \code{300}.}

\item{plot_titles}{Optional character vector of titles (length = length(plot)).
If \code{NULL}, \code{names(plot)} are used when available; otherwise no titles.}

\item{title_size}{Numeric font size for titles. Default \code{14}.}

\item{font_name}{Font family for title text (passed to openxlsx style).
Default \code{getOption("instead.font")}.}

\item{row_spacer}{Non-negative integer. Blank rows between stacked plots.
Default \code{2L}.}

\item{rows_per_inch}{Approximate number of worksheet rows consumed per one
inch of plot height in stack mode. Default \code{5}.}

\item{overwrite}{Overwrite existing workbook on save? Default \code{FALSE}.}
}
\value{
(Invisibly) the path to \code{file}. Side-effects: creates/updates an Excel file.
}
\description{
Writes one or more ggplots to a single worksheet using \code{openxlsx}.
\itemize{
\item If \code{rc} is a length-2 integer vector (e.g., \code{c(1L, 1L)}), plots are
stacked vertically with an optional title row and \code{row_spacer} blank rows
between plots. The next start row is approximated as:
1 (title if present) + ceiling(height * rows_per_inch) + row_spacer.
\item If \code{rc} is a list of \code{c(row, col)} pairs with the same length as \code{plot},
each plot is placed at its specified position (no stacking).
}
}
\examples{
\dontrun{
library(ggplot2)

p1 <- ggplot(mtcars, aes(mpg, wt)) + geom_point()
p2 <- ggplot(mtcars, aes(hp, qsec)) + geom_point()

# 1) Fixed positions (list rc): place two plots at different rows
save_plot_xlsx(
  plot   = list("Scatter 1" = p1, "Scatter 2" = p2),
  file   = "plots_positions.xlsx",
  sheet  = "Plots",
  rc     = list(c(1, 1), c(30, 1)),
  plot_titles = NULL,      # uses names(plot) as titles
  title_size  = 16,
  width = 8, height = 4, dpi = 300,
  overwrite = TRUE
)

# 2) Stack mode (single rc): place plots top-to-bottom with spacing
save_plot_xlsx(
  plot   = list(p1, p2),
  file   = "plots_stacked.xlsx",
  sheet  = "Plots",
  rc     = c(1L, 1L),
  plot_titles = c("MPG vs Weight", "HP vs QSEC"),
  row_spacer  = 2L,
  width = 8, height = 4, dpi = 300,
  overwrite = TRUE
)
}

}
\seealso{
\code{\link[=save_plot_wb]{save_plot_wb()}}, \code{\link[openxlsx:insertPlot]{openxlsx::insertPlot()}}
}
