% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/excel.R
\name{write_data}
\alias{write_data}
\title{Write a styled data.frame to an Excel worksheet}
\usage{
write_data(
  wb,
  sheet,
  data,
  rc = c(1L, 1L),
  row_names = TRUE,
  font_name = getOption("instead.font"),
  font_size = 11,
  border_colour = "#000000",
  widths = 8.43,
  num_fmt = NULL
)
}
\arguments{
\item{wb}{A Workbook object created by \code{\link[openxlsx:createWorkbook]{openxlsx::createWorkbook()}} or
\code{\link[openxlsx:loadWorkbook]{openxlsx::loadWorkbook()}}.}

\item{sheet}{A single sheet name (character scalar).}

\item{data}{A \code{data.frame} (or \code{matrix}) to write.}

\item{rc}{A length-2 integer vector giving the starting row and column
(\code{c(row, col)}). Default \code{c(1L, 1L)}.}

\item{row_names}{Logical; whether to include row names. Default \code{TRUE}.}

\item{font_name}{Character font family for all text. Default
\code{getOption("instead.font")}.}

\item{font_size}{Numeric font size for all text. Default \code{11}.}

\item{border_colour}{Border colour (hex string). Default \code{"#000000"}.}

\item{widths}{Column width(s) to apply. Can be a single numeric (recycled)
or a numeric vector matching the number of columns. Default \code{8.43}.}

\item{num_fmt}{Optional numeric format(s) applied to data cells (headers
excluded). Accepts either:
\itemize{
\item A \strong{single character format string} applied to all numeric cells
(e.g. \code{"0.00"} for 2 decimals, \code{"#,##0"} for thousands separator,
\code{"0.00\%"} for percentages).
\item A \strong{named character vector or list} mapping column names to formats,
e.g. \code{c(value = "#,##0", rate = "0.0\%")}. Columns not listed are left
unchanged. Unknown column names are silently ignored.
}}
}
\value{
No return value. Called for side effects (writes into workbook).
}
\description{
Low-level helper for writing tabular data into an Excel sheet with
consistent styling. Intended for use inside higher-level wrappers
(e.g., \code{\link[=save_data_xlsx]{save_data_xlsx()}}, \code{\link[=save_data_xlsx_split]{save_data_xlsx_split()}}).
}
\details{
Features:
\itemize{
\item Writes data at the specified start cell (\code{rc}).
\item Optionally includes row names.
\item Applies different styles for header, body, and footer cells:
\itemize{
\item \strong{Header}: grey fill, bold borders (thick/double at edges).
\item \strong{Body}: thin borders (left/middle vs. right edge distinguished).
\item \strong{Footer}: thicker bottom border.
}
\item Sets column widths (fixed or vectorized).
}

Formatting strings follow Excel's built-in custom number formats. Some
common patterns:
\itemize{
\item \code{"0"} -> integers
\item \code{"0.00"} -> fixed 2 decimals
\item \code{"#,##0"} -> thousands separator
\item \code{"0.00\%"} -> percentages with 2 decimals
}
}
\examples{
\dontrun{
wb <- openxlsx::createWorkbook()
openxlsx::addWorksheet(wb, "Example")
write_data(
  wb, "Example",
  data = head(mtcars),
  rc = c(2, 2),
  row_names = FALSE,
  font_name = "Calibri",
  font_size = 11,
  border_colour = "#333333",
  widths = 10
)
openxlsx::saveWorkbook(wb, "styled_data.xlsx", overwrite = TRUE)
}

}
